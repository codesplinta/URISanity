/*!
 * URISanity: Date=Thu May 12 2022 13:22:46 GMT+0100 (West Africa Standard Time);NodeBuildVersion=14
 *
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).urisanity=t()}(this,(function(){"use strict";var e=/^([^\w]*)(unsafe|javascript|vbscript|app|admin|icloud-sharing|icloud-vetting|help|aim|facetime-audio|applefeedback|ibooks|macappstore|udoc|ts|st|x-apple-helpbasic|(?:x\-)?radar)/im,t=/^(?:(?:f|ht)tps?|cid|xmpp|mms|webcal|aaa|acap|bolo|data|blob|file|local|wss?|irc|udp)/im,a=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/?)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\)){0,}(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s\!()\[\]{};:\'\"\.\,<>?«»“”‘’]){0,})/i,s=/^(whatsapp|zoommtg|slack|mailto|tel|callto|sms|skype)/im,r=/^(jdbc(:sqlserver|:mysql|:mariadb|:sqlite)?|odbc|postgres(ql)?|mongodb)/im,i=/^(view-source|moz-extension|(?:filesystem:|blob:)?chrome-extension)/im,o=/^(file|local|blob)/im,n=/^(cloudinary|obsidian|gs|s3|grpc)/im,d=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,c=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|svg\+xml)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,(?:[a-zA-Z0-9\/+\n=]+)$/i,l=/^data:(?:text\/(?:javascript|html|css|plain))(?:;charset=(UTF-8|iso-8859-7))?,(?:.*)$/im,u=/^(?:vb|java)(?:\s*)?script/im,f=/^(?:(blob:)?https?|wss?|about)/im,m=[".","/"],p="undefined"==typeof self?global||{}:self,v=p.process||{versions:{node:"."},env:{}},h=parseInt(v.versions.node.split(".")[0]);h<=12&&(p.URL||(p.URL=function(e){var t=require("url"),a=h<=11?t.parse(e):t.URL(e);return Object.assign({},a,{hostname:a.host})}));var w,b=void 0!==(w=p.navigator)&&null===w.product.match(/^(ReactNative|NativeScript|NS)$/i)?p.location.origin:(p.constants||v.env).ORIGIN;function g(e){return"string"==typeof e&&m.indexOf(e.charAt(0))>-1}function F(e){var t=void 0,a=void 0,s=void 0,r=void 0,i=void 0;r={};var o=e instanceof p.FormData?e.entries():new p.FormData(e).entries();try{for(;null!==(a=o.next().value);)s=a[0],i=a[1],Object.prototype.hasOwnProperty.call(r,s)?(t=r[s],Array.isArray(t)||(t=r[s]=[t]),t.push(i)):r[s]=i}catch(e){r=Object.fromEntries(o)}return JSON.stringify(r)}function L(l){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!l||null!==l.match(/:\/\/(?:[#$@=*.!]|[/]){0,}$/)||l.includes("////////////"))return"about:blank";var v=l.replace(d,"").trim();if(g(v)){var h=v.startsWith("/")?b+v:b+"/"+v;v=a.test(h)?h:"//"}var w=v.match(t)||v.match(s)||v.match(r)||v.match(i)||v.match(n)||v.match(f),F=(w=null!==w?w:[])[0]||"";try{var L=new p.URL(v.toLowerCase()),A=L.hostname,y=L.pathname,C=L.search,R=L.hash;if(/^(?:((?:www|[a-z]{1,11})\.)(?!\1)(?:[a-z\-\d]{1,63})\.(?:[a-z.\-\d]{2,63}))$/i.test(A)||/^(((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/.test(A)||/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/.test(A)||/^(?:((?:[a-z0-9-._~]{0,}|%[1-9a-f]?[0-9a-f]|[!$&'()*+,;=])|\:|\@)*)/i.test(y)||/^((?:[a-z0-9-._~]{0,}|%[1-9a-f]?[0-9a-f]|[!$&'()*+,;=])|\:|\@|\/|\?)*$/i.test(C)||/^((?:[a-z0-9-._~]{0,}|%[1-9a-f]?[0-9a-f]|[!$&'()*+,;=])|\:|\@|\/|\?)*$/i.test(R)){if(A.includes(".00"))return"about:blank";if(y.toLowerCase().includes("&apos;")||y.toLowerCase().includes("%29")||y.toLowerCase().includes("%28")||y.toLowerCase().includes("%20")||y.toLowerCase().includes("%22")||y.toLowerCase().includes("&quot;")||y.toLowerCase().includes("(")||y.toLowerCase().includes(")")||y.toLowerCase().includes("%3e")||y.toLowerCase().includes("%3c")||y.toLowerCase().includes("><"))return"about:blank";if(null!==C.toLowerCase().match(/%3c(?=\/)?/g)||C.toLowerCase().includes("%3e")||C.toLowerCase().includes("%3f")||C.toLowerCase().includes("%3d")||C.toLowerCase().includes("%27")||C.toLowerCase().includes("%22")||C.toLowerCase().includes("&apos;")||C.toLowerCase().includes("&quot;")||null!==C.toLowerCase().match(/\.(?:jar|dmg|exe|bin|sh|sed|py)/g))return"about:blank"}}catch(e){if(e)return"about:blank"}if(!e.test(F)||a.test(v)){var j=!1;return m.allowScriptOrDataURI&&null!==F.match(/^(java|vb)script|data/)&&(c.test(v)||u.test(v))&&(j=!0),m.allowCommsAppURI&&s.test(v)&&(j=!0),m.allowDBConnectionStringURI&&r.test(v)&&(j=!0),m.allowServiceAPIURI&&n.test(v)&&(j=!0),m.allowBrowserSpecificURI&&i.test(v)&&(j=!0),m.allowWebTransportURI&&f.test(v)&&(j=!0),m.allowFileSystemURI&&o.test(v)&&(j=!0),""!==F&&j?v:"about:blank"}}var A={isSameOrigin:function(e){if(!e||l.test(e.trim())||c.test(e.trim()))return!1;try{var t=new p.URL(e.trim());return b===t.origin}catch(e){if(e)return!1}},extractParamValueFromUri:function(e,t){if(!e||l.test(e.trim())||c.test(e.trim()))return null;var a=new RegExp("[\\?&#]"+t+"=([^&#]*)").exec(e.trim());return null!=a?unescape(a[1]):void 0},checkParamsOverWhiteList:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!e||l.test(e.trim())||c.test(e.trim()))return!1;var s=new p.URL(e.trim()),r=[],i=[],o=null;try{var n="";if("FormData"in p&&a instanceof p.FormData)if("function"==typeof Object.fromEntries)n=F(a);else{var d={};a.forEach((function(e,t){d[t]=e})),n=JSON.stringify(d)}else n=a;"string"==typeof n&&(o=JSON.parse(n))}catch(e){o=a}return""===o?s.searchParams.forEach((function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];var s=t[0],o=t[1];i.push(unescape(s)),r.push(o)})):o instanceof Object&&i.concat(Object.values(o)),r.length===t.length},vet:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return L(e,t||{})}};return A}));
//# sourceMappingURL=urisanity.min.js.map
